load("maxwell/em-div-b")$
load(stringproc)$
/* This script calls the functions which generate the kernels for calculating div(b) and the max(|b_i|) penalization.

   div(b) is computed with averaging to ensure phase space incompressibility in the weak sense. */


/* ...... USER INPUTS........ */

/* Tensor product basis. 
   Note: flow velocity is only p=1, while kinetic variables are p=2 */
minPolyOrder_Tensor : 2$
maxPolyOrder_Tensor : 2$
minCdim_Tensor : 1$
maxCdim_Tensor : 3$

/* ...... END OF USER INPUTS........ */

clabels : ["x","y","z"]$
for d : minCdim_Tensor thru maxCdim_Tensor do (
  for polyOrder : minPolyOrder_Tensor thru maxPolyOrder_Tensor do (
    disp(printf(false,sconcat("Creating em vars div(b) funcs ",bName[bInd]," ~axp~a"),d,polyOrder)),
    for dir : 1 thru d do ( 
      fname : sconcat("~/max-out/em_div_b_", clabels[dir], "_", d, "x_", "tensor_p", polyOrder, ".c"),
      fh : openw(fname),
      funcName : sconcat("em_div_b_", clabels[dir],"_", d, "x_", "tensor_p", polyOrder),
      calcdivb(dir, fh, funcName, d, polyOrder),
      close(fh)
    )
  )
);
