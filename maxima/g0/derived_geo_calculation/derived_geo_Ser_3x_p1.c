GKYL_CU_DH void derived_geo_3x_Ser_p1(const double *gij, double *J) 
{ 
double *g11  = &gij[0 * 8];
double *g12  = &gij[1 * 8];
double *g13  = &gij[2 * 8];
double *g22  = &gij[3 * 8];
double *g23  = &gij[4 * 8];
double *g33  = &gij[5 * 8];
double g11_n[8]; 
double g12_n[8]; 
double g13_n[8]; 
double g22_n[8]; 
double g23_n[8]; 
double g33_n[8]; 
double *g21_n = g12_n; 
double *g31_n = g13_n; 
double *g32_n = g23_n; 
// Calculate g_ij at nodes 
 g11_n[0] = (-1.837117307087383*g11[7])+1.060660171779821*g11[6]+1.060660171779821*g11[5]+1.060660171779821*g11[4]-0.6123724356957944*g11[3]-0.6123724356957944*g11[2]-0.6123724356957944*g11[1]+0.3535533905932737*g11[0]; 
 g11_n[1] = 1.837117307087383*g11[7]+1.060660171779821*g11[6]-1.060660171779821*g11[5]-1.060660171779821*g11[4]-0.6123724356957944*g11[3]-0.6123724356957944*g11[2]+0.6123724356957944*g11[1]+0.3535533905932737*g11[0]; 
 g11_n[2] = 1.837117307087383*g11[7]-1.060660171779821*g11[6]+1.060660171779821*g11[5]-1.060660171779821*g11[4]-0.6123724356957944*g11[3]+0.6123724356957944*g11[2]-0.6123724356957944*g11[1]+0.3535533905932737*g11[0]; 
 g11_n[3] = (-1.837117307087383*g11[7])-1.060660171779821*g11[6]-1.060660171779821*g11[5]+1.060660171779821*g11[4]-0.6123724356957944*g11[3]+0.6123724356957944*g11[2]+0.6123724356957944*g11[1]+0.3535533905932737*g11[0]; 
 g11_n[4] = 1.837117307087383*g11[7]-1.060660171779821*g11[6]-1.060660171779821*g11[5]+1.060660171779821*g11[4]+0.6123724356957944*g11[3]-0.6123724356957944*g11[2]-0.6123724356957944*g11[1]+0.3535533905932737*g11[0]; 
 g11_n[5] = (-1.837117307087383*g11[7])-1.060660171779821*g11[6]+1.060660171779821*g11[5]-1.060660171779821*g11[4]+0.6123724356957944*g11[3]-0.6123724356957944*g11[2]+0.6123724356957944*g11[1]+0.3535533905932737*g11[0]; 
 g11_n[6] = (-1.837117307087383*g11[7])+1.060660171779821*g11[6]-1.060660171779821*g11[5]-1.060660171779821*g11[4]+0.6123724356957944*g11[3]+0.6123724356957944*g11[2]-0.6123724356957944*g11[1]+0.3535533905932737*g11[0]; 
 g11_n[7] = 1.837117307087383*g11[7]+1.060660171779821*g11[6]+1.060660171779821*g11[5]+1.060660171779821*g11[4]+0.6123724356957944*g11[3]+0.6123724356957944*g11[2]+0.6123724356957944*g11[1]+0.3535533905932737*g11[0]; 
 g12_n[0] = (-1.837117307087383*g12[7])+1.060660171779821*g12[6]+1.060660171779821*g12[5]+1.060660171779821*g12[4]-0.6123724356957944*g12[3]-0.6123724356957944*g12[2]-0.6123724356957944*g12[1]+0.3535533905932737*g12[0]; 
 g12_n[1] = 1.837117307087383*g12[7]+1.060660171779821*g12[6]-1.060660171779821*g12[5]-1.060660171779821*g12[4]-0.6123724356957944*g12[3]-0.6123724356957944*g12[2]+0.6123724356957944*g12[1]+0.3535533905932737*g12[0]; 
 g12_n[2] = 1.837117307087383*g12[7]-1.060660171779821*g12[6]+1.060660171779821*g12[5]-1.060660171779821*g12[4]-0.6123724356957944*g12[3]+0.6123724356957944*g12[2]-0.6123724356957944*g12[1]+0.3535533905932737*g12[0]; 
 g12_n[3] = (-1.837117307087383*g12[7])-1.060660171779821*g12[6]-1.060660171779821*g12[5]+1.060660171779821*g12[4]-0.6123724356957944*g12[3]+0.6123724356957944*g12[2]+0.6123724356957944*g12[1]+0.3535533905932737*g12[0]; 
 g12_n[4] = 1.837117307087383*g12[7]-1.060660171779821*g12[6]-1.060660171779821*g12[5]+1.060660171779821*g12[4]+0.6123724356957944*g12[3]-0.6123724356957944*g12[2]-0.6123724356957944*g12[1]+0.3535533905932737*g12[0]; 
 g12_n[5] = (-1.837117307087383*g12[7])-1.060660171779821*g12[6]+1.060660171779821*g12[5]-1.060660171779821*g12[4]+0.6123724356957944*g12[3]-0.6123724356957944*g12[2]+0.6123724356957944*g12[1]+0.3535533905932737*g12[0]; 
 g12_n[6] = (-1.837117307087383*g12[7])+1.060660171779821*g12[6]-1.060660171779821*g12[5]-1.060660171779821*g12[4]+0.6123724356957944*g12[3]+0.6123724356957944*g12[2]-0.6123724356957944*g12[1]+0.3535533905932737*g12[0]; 
 g12_n[7] = 1.837117307087383*g12[7]+1.060660171779821*g12[6]+1.060660171779821*g12[5]+1.060660171779821*g12[4]+0.6123724356957944*g12[3]+0.6123724356957944*g12[2]+0.6123724356957944*g12[1]+0.3535533905932737*g12[0]; 
 g13_n[0] = (-1.837117307087383*g13[7])+1.060660171779821*g13[6]+1.060660171779821*g13[5]+1.060660171779821*g13[4]-0.6123724356957944*g13[3]-0.6123724356957944*g13[2]-0.6123724356957944*g13[1]+0.3535533905932737*g13[0]; 
 g13_n[1] = 1.837117307087383*g13[7]+1.060660171779821*g13[6]-1.060660171779821*g13[5]-1.060660171779821*g13[4]-0.6123724356957944*g13[3]-0.6123724356957944*g13[2]+0.6123724356957944*g13[1]+0.3535533905932737*g13[0]; 
 g13_n[2] = 1.837117307087383*g13[7]-1.060660171779821*g13[6]+1.060660171779821*g13[5]-1.060660171779821*g13[4]-0.6123724356957944*g13[3]+0.6123724356957944*g13[2]-0.6123724356957944*g13[1]+0.3535533905932737*g13[0]; 
 g13_n[3] = (-1.837117307087383*g13[7])-1.060660171779821*g13[6]-1.060660171779821*g13[5]+1.060660171779821*g13[4]-0.6123724356957944*g13[3]+0.6123724356957944*g13[2]+0.6123724356957944*g13[1]+0.3535533905932737*g13[0]; 
 g13_n[4] = 1.837117307087383*g13[7]-1.060660171779821*g13[6]-1.060660171779821*g13[5]+1.060660171779821*g13[4]+0.6123724356957944*g13[3]-0.6123724356957944*g13[2]-0.6123724356957944*g13[1]+0.3535533905932737*g13[0]; 
 g13_n[5] = (-1.837117307087383*g13[7])-1.060660171779821*g13[6]+1.060660171779821*g13[5]-1.060660171779821*g13[4]+0.6123724356957944*g13[3]-0.6123724356957944*g13[2]+0.6123724356957944*g13[1]+0.3535533905932737*g13[0]; 
 g13_n[6] = (-1.837117307087383*g13[7])+1.060660171779821*g13[6]-1.060660171779821*g13[5]-1.060660171779821*g13[4]+0.6123724356957944*g13[3]+0.6123724356957944*g13[2]-0.6123724356957944*g13[1]+0.3535533905932737*g13[0]; 
 g13_n[7] = 1.837117307087383*g13[7]+1.060660171779821*g13[6]+1.060660171779821*g13[5]+1.060660171779821*g13[4]+0.6123724356957944*g13[3]+0.6123724356957944*g13[2]+0.6123724356957944*g13[1]+0.3535533905932737*g13[0]; 
 g12_n[0] = (-1.837117307087383*g22[7])+1.060660171779821*g22[6]+1.060660171779821*g22[5]+1.060660171779821*g22[4]-0.6123724356957944*g22[3]-0.6123724356957944*g22[2]-0.6123724356957944*g22[1]+0.3535533905932737*g22[0]; 
 g12_n[1] = 1.837117307087383*g22[7]+1.060660171779821*g22[6]-1.060660171779821*g22[5]-1.060660171779821*g22[4]-0.6123724356957944*g22[3]-0.6123724356957944*g22[2]+0.6123724356957944*g22[1]+0.3535533905932737*g22[0]; 
 g12_n[2] = 1.837117307087383*g22[7]-1.060660171779821*g22[6]+1.060660171779821*g22[5]-1.060660171779821*g22[4]-0.6123724356957944*g22[3]+0.6123724356957944*g22[2]-0.6123724356957944*g22[1]+0.3535533905932737*g22[0]; 
 g12_n[3] = (-1.837117307087383*g22[7])-1.060660171779821*g22[6]-1.060660171779821*g22[5]+1.060660171779821*g22[4]-0.6123724356957944*g22[3]+0.6123724356957944*g22[2]+0.6123724356957944*g22[1]+0.3535533905932737*g22[0]; 
 g12_n[4] = 1.837117307087383*g22[7]-1.060660171779821*g22[6]-1.060660171779821*g22[5]+1.060660171779821*g22[4]+0.6123724356957944*g22[3]-0.6123724356957944*g22[2]-0.6123724356957944*g22[1]+0.3535533905932737*g22[0]; 
 g12_n[5] = (-1.837117307087383*g22[7])-1.060660171779821*g22[6]+1.060660171779821*g22[5]-1.060660171779821*g22[4]+0.6123724356957944*g22[3]-0.6123724356957944*g22[2]+0.6123724356957944*g22[1]+0.3535533905932737*g22[0]; 
 g12_n[6] = (-1.837117307087383*g22[7])+1.060660171779821*g22[6]-1.060660171779821*g22[5]-1.060660171779821*g22[4]+0.6123724356957944*g22[3]+0.6123724356957944*g22[2]-0.6123724356957944*g22[1]+0.3535533905932737*g22[0]; 
 g12_n[7] = 1.837117307087383*g22[7]+1.060660171779821*g22[6]+1.060660171779821*g22[5]+1.060660171779821*g22[4]+0.6123724356957944*g22[3]+0.6123724356957944*g22[2]+0.6123724356957944*g22[1]+0.3535533905932737*g22[0]; 
 g13_n[0] = (-1.837117307087383*g23[7])+1.060660171779821*g23[6]+1.060660171779821*g23[5]+1.060660171779821*g23[4]-0.6123724356957944*g23[3]-0.6123724356957944*g23[2]-0.6123724356957944*g23[1]+0.3535533905932737*g23[0]; 
 g13_n[1] = 1.837117307087383*g23[7]+1.060660171779821*g23[6]-1.060660171779821*g23[5]-1.060660171779821*g23[4]-0.6123724356957944*g23[3]-0.6123724356957944*g23[2]+0.6123724356957944*g23[1]+0.3535533905932737*g23[0]; 
 g13_n[2] = 1.837117307087383*g23[7]-1.060660171779821*g23[6]+1.060660171779821*g23[5]-1.060660171779821*g23[4]-0.6123724356957944*g23[3]+0.6123724356957944*g23[2]-0.6123724356957944*g23[1]+0.3535533905932737*g23[0]; 
 g13_n[3] = (-1.837117307087383*g23[7])-1.060660171779821*g23[6]-1.060660171779821*g23[5]+1.060660171779821*g23[4]-0.6123724356957944*g23[3]+0.6123724356957944*g23[2]+0.6123724356957944*g23[1]+0.3535533905932737*g23[0]; 
 g13_n[4] = 1.837117307087383*g23[7]-1.060660171779821*g23[6]-1.060660171779821*g23[5]+1.060660171779821*g23[4]+0.6123724356957944*g23[3]-0.6123724356957944*g23[2]-0.6123724356957944*g23[1]+0.3535533905932737*g23[0]; 
 g13_n[5] = (-1.837117307087383*g23[7])-1.060660171779821*g23[6]+1.060660171779821*g23[5]-1.060660171779821*g23[4]+0.6123724356957944*g23[3]-0.6123724356957944*g23[2]+0.6123724356957944*g23[1]+0.3535533905932737*g23[0]; 
 g13_n[6] = (-1.837117307087383*g23[7])+1.060660171779821*g23[6]-1.060660171779821*g23[5]-1.060660171779821*g23[4]+0.6123724356957944*g23[3]+0.6123724356957944*g23[2]-0.6123724356957944*g23[1]+0.3535533905932737*g23[0]; 
 g13_n[7] = 1.837117307087383*g23[7]+1.060660171779821*g23[6]+1.060660171779821*g23[5]+1.060660171779821*g23[4]+0.6123724356957944*g23[3]+0.6123724356957944*g23[2]+0.6123724356957944*g23[1]+0.3535533905932737*g23[0]; 
 g13_n[0] = (-1.837117307087383*g33[7])+1.060660171779821*g33[6]+1.060660171779821*g33[5]+1.060660171779821*g33[4]-0.6123724356957944*g33[3]-0.6123724356957944*g33[2]-0.6123724356957944*g33[1]+0.3535533905932737*g33[0]; 
 g13_n[1] = 1.837117307087383*g33[7]+1.060660171779821*g33[6]-1.060660171779821*g33[5]-1.060660171779821*g33[4]-0.6123724356957944*g33[3]-0.6123724356957944*g33[2]+0.6123724356957944*g33[1]+0.3535533905932737*g33[0]; 
 g13_n[2] = 1.837117307087383*g33[7]-1.060660171779821*g33[6]+1.060660171779821*g33[5]-1.060660171779821*g33[4]-0.6123724356957944*g33[3]+0.6123724356957944*g33[2]-0.6123724356957944*g33[1]+0.3535533905932737*g33[0]; 
 g13_n[3] = (-1.837117307087383*g33[7])-1.060660171779821*g33[6]-1.060660171779821*g33[5]+1.060660171779821*g33[4]-0.6123724356957944*g33[3]+0.6123724356957944*g33[2]+0.6123724356957944*g33[1]+0.3535533905932737*g33[0]; 
 g13_n[4] = 1.837117307087383*g33[7]-1.060660171779821*g33[6]-1.060660171779821*g33[5]+1.060660171779821*g33[4]+0.6123724356957944*g33[3]-0.6123724356957944*g33[2]-0.6123724356957944*g33[1]+0.3535533905932737*g33[0]; 
 g13_n[5] = (-1.837117307087383*g33[7])-1.060660171779821*g33[6]+1.060660171779821*g33[5]-1.060660171779821*g33[4]+0.6123724356957944*g33[3]-0.6123724356957944*g33[2]+0.6123724356957944*g33[1]+0.3535533905932737*g33[0]; 
 g13_n[6] = (-1.837117307087383*g33[7])+1.060660171779821*g33[6]-1.060660171779821*g33[5]-1.060660171779821*g33[4]+0.6123724356957944*g33[3]+0.6123724356957944*g33[2]-0.6123724356957944*g33[1]+0.3535533905932737*g33[0]; 
 g13_n[7] = 1.837117307087383*g33[7]+1.060660171779821*g33[6]+1.060660171779821*g33[5]+1.060660171779821*g33[4]+0.6123724356957944*g33[3]+0.6123724356957944*g33[2]+0.6123724356957944*g33[1]+0.3535533905932737*g33[0]; 
// Calculate J at nodes 
  J_n[0] = g11_n[0]*(g22_n[0]*g33_n[0]-1.0*g23_n[0]*g32_n[0])-1.0*g12_n[0]*(g21_n[0]*g33_n[0]-1.0*g23_n[0]*g31_n[0])+g13_n[0]*(g21_n[0]*g32_n[0]-1.0*g22_n[0]*g31_n[0]); 
  J_n[1] = g11_n[1]*(g22_n[1]*g33_n[1]-1.0*g23_n[1]*g32_n[1])-1.0*g12_n[1]*(g21_n[1]*g33_n[1]-1.0*g23_n[1]*g31_n[1])+g13_n[1]*(g21_n[1]*g32_n[1]-1.0*g22_n[1]*g31_n[1]); 
  J_n[2] = g11_n[2]*(g22_n[2]*g33_n[2]-1.0*g23_n[2]*g32_n[2])-1.0*g12_n[2]*(g21_n[2]*g33_n[2]-1.0*g23_n[2]*g31_n[2])+g13_n[2]*(g21_n[2]*g32_n[2]-1.0*g22_n[2]*g31_n[2]); 
  J_n[3] = g11_n[3]*(g22_n[3]*g33_n[3]-1.0*g23_n[3]*g32_n[3])-1.0*g12_n[3]*(g21_n[3]*g33_n[3]-1.0*g23_n[3]*g31_n[3])+g13_n[3]*(g21_n[3]*g32_n[3]-1.0*g22_n[3]*g31_n[3]); 
  J_n[4] = g11_n[4]*(g22_n[4]*g33_n[4]-1.0*g23_n[4]*g32_n[4])-1.0*g12_n[4]*(g21_n[4]*g33_n[4]-1.0*g23_n[4]*g31_n[4])+g13_n[4]*(g21_n[4]*g32_n[4]-1.0*g22_n[4]*g31_n[4]); 
  J_n[5] = g11_n[5]*(g22_n[5]*g33_n[5]-1.0*g23_n[5]*g32_n[5])-1.0*g12_n[5]*(g21_n[5]*g33_n[5]-1.0*g23_n[5]*g31_n[5])+g13_n[5]*(g21_n[5]*g32_n[5]-1.0*g22_n[5]*g31_n[5]); 
  J_n[6] = g11_n[6]*(g22_n[6]*g33_n[6]-1.0*g23_n[6]*g32_n[6])-1.0*g12_n[6]*(g21_n[6]*g33_n[6]-1.0*g23_n[6]*g31_n[6])+g13_n[6]*(g21_n[6]*g32_n[6]-1.0*g22_n[6]*g31_n[6]); 
  J_n[7] = g11_n[7]*(g22_n[7]*g33_n[7]-1.0*g23_n[7]*g32_n[7])-1.0*g12_n[7]*(g21_n[7]*g33_n[7]-1.0*g23_n[7]*g31_n[7])+g13_n[7]*(g21_n[7]*g32_n[7]-1.0*g22_n[7]*g31_n[7]); 
J_n[0] = sqrt(J_n[0]) 
J_n[1] = sqrt(J_n[1]) 
J_n[2] = sqrt(J_n[2]) 
J_n[3] = sqrt(J_n[3]) 
J_n[4] = sqrt(J_n[4]) 
J_n[5] = sqrt(J_n[5]) 
J_n[6] = sqrt(J_n[6]) 
J_n[7] = sqrt(J_n[7]) 
// Convert nodal to modal for J 
  J[0] = 0.353553390593274*J_n[7]+0.3535533905932739*J_n[6]+0.3535533905932739*J_n[5]+0.3535533905932739*J_n[4]+0.3535533905932737*J_n[3]+0.3535533905932737*J_n[2]+0.3535533905932737*J_n[1]+0.3535533905932737*J_n[0]; 
  J[1] = 0.2041241452319316*J_n[7]-0.2041241452319316*J_n[6]+0.2041241452319316*J_n[5]-0.2041241452319316*J_n[4]+0.2041241452319315*J_n[3]-0.2041241452319315*J_n[2]+0.2041241452319315*J_n[1]-0.2041241452319315*J_n[0]; 
  J[2] = 0.2041241452319316*J_n[7]+0.2041241452319316*J_n[6]-0.2041241452319316*J_n[5]-0.2041241452319316*J_n[4]+0.2041241452319315*J_n[3]+0.2041241452319315*J_n[2]-0.2041241452319315*J_n[1]-0.2041241452319315*J_n[0]; 
  J[3] = 0.2041241452319315*J_n[7]+0.2041241452319316*J_n[6]+0.2041241452319316*J_n[5]+0.2041241452319316*J_n[4]-0.2041241452319315*J_n[3]-0.2041241452319315*J_n[2]-0.2041241452319315*J_n[1]-0.2041241452319315*J_n[0]; 
  J[4] = 0.117851130197758*J_n[7]-0.117851130197758*J_n[6]-0.117851130197758*J_n[5]+0.117851130197758*J_n[4]+0.1178511301977579*J_n[3]-0.1178511301977579*J_n[2]-0.1178511301977579*J_n[1]+0.1178511301977579*J_n[0]; 
  J[5] = 0.1178511301977579*J_n[7]-0.117851130197758*J_n[6]+0.117851130197758*J_n[5]-0.117851130197758*J_n[4]-0.1178511301977579*J_n[3]+0.1178511301977579*J_n[2]-0.1178511301977579*J_n[1]+0.1178511301977579*J_n[0]; 
  J[6] = 0.1178511301977579*J_n[7]+0.117851130197758*J_n[6]-0.1178511301977579*J_n[5]-0.1178511301977579*J_n[4]-0.1178511301977579*J_n[3]-0.1178511301977579*J_n[2]+0.1178511301977579*J_n[1]+0.1178511301977579*J_n[0]; 
  J[7] = 0.0680413817439772*J_n[7]-0.06804138174397721*J_n[6]-0.06804138174397721*J_n[5]+0.06804138174397721*J_n[4]-0.06804138174397717*J_n[3]+0.06804138174397717*J_n[2]+0.06804138174397717*J_n[1]-0.06804138174397717*J_n[0]; 
 
}
